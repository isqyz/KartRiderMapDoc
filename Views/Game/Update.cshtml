@model dynamic
@{
    ViewBag.Title = "玩家成绩管理";
    var Tracks = @Model.tracks;
    Player player = @Model.player;
    TrackScoreMark mark = @Model.mark;
}

<h2>输入或更新玩家成绩</h2>

<form method="post" action="/Game/AddOrUpdate">

    <div>
        <label for="playerName">玩家名:</label>
        <input list="options" id="playerName" name="playerName"  required />
        <datalist id="options">
            @foreach (var p in Model.players)
            {
                <option value="@p.PlayerName"></option>
            }
        </datalist>


    </div>

    <div>
        <label for="trackId">赛道名:</label>
        <select id="trackId" name="trackId">
            @foreach (var t in Tracks)
            {
                @if (t.TrackName == "1")
                {
                    <option value="@t.Id" selected>@t</option>
                }
                else
                {
                    <option value="@t.Id">@t.TrackName</option>
                }

            }
        </select>
    </div>

    <div>
        <label for="score">成绩:</label>
        <input type="text" id="score" name="score" placeholder="mm:ss:SSS" maxlength="8" required />

    </div>

    <button type="submit">保存</button>
</form>
<script>
    document.getElementById('score').addEventListener('input', function (event) {
        let value = event.target.value.replace(/[^0-9]/g, ''); // 移除所有非数字字符
        if (value.length <= 0) {
            // 小于等于2位数，格式为 H
            value = value;
        } else if (value.length <= 2) {
            // 小于等于4位数，格式为 H:mm
            value = value.substring(0, 1) + ':' + value.substring(1);
        } else if (value.length <= 7) {
            // 小于等于7位数，格式为 H:mm:ss
            value = value.substring(0, 1) + ':' + value.substring(1, 3) + ':' + value.substring(3);
        } else {
            // 超过7位，截取前7位
            value = value.substring(0, 7);
        }

        // 更新输入框的值
        event.target.value = value;
    });
</script>